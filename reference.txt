  inputs:
    AppSecTestService: 'ASoC Credentials'
    applications: '064f6246-05fa-4461-92b1-c1e8bbfdf1a7'
    scantype: 'dynamic'
    dynamicType: 'DAST'
    scanURL: 'demo.testfire.net'
    type: 'staging'
    loginMethod: 'Record'
    network: 'private'
    dynamicpresence: 'e9ca59f8-4688-eb11-85aa-2818780a4fcb'
    email: true
    personalScan: true
    FailBuildConfiguration: true
    FailBuildChoice: 'conditionset'
    buildfailconditionTotal: '5'
    buildfailHigh: true
    buildfailconditionHigh: '3'
    buildfailMedium: true
    buildfailconditionMedium: '2'
    buildfailLow: true
    buildfailconditionLow: '1'



name: 'HCL AppScan Static Analyzer'
description: 'Scan for security issues in code'
branding:
  color: 'blue'
  icon: 'lock'  
inputs:
  asoc_key:
    description: 'API key for connecting to ASoC.'
    required: true
  asoc_secret:
    description: 'Secret for connecting to ASoC.'
    required: true
  application_id:
    description: 'The ASoC application id where your scan will appear.'
    required: true
  scan_name:
    description: 'The name of the scan created in ASoC.'
    required: false
  personal_scan:
    description: 'Make the scan a personal scan.'
    required: false
    type: boolean
    default: false
  static_analysis_only:
    description: 'Only run static analysis. Do not run SCA (Software Composition Analysis).'
    required: false
    type: boolean
    default: false
  open_source_only:
    description: 'Only run SCA (Software Composition Analysis). Do not run static analysis.'
    required: false
    type: boolean
    default: false
  scan_build_outputs:
    description: 'By default only source code files will be analyzed. Enabling this option will result in build output files for Java and .NET to be analyzed (.jar/.war/.ear/.dll/.exe). Additionally, Maven, Gradle, and Visual Studio solutions will be built if the build environment is available.'
    required: false
    type: boolean
    default: false
  wait_for_analysis:
    description: 'By default this action will initiate the scan in ASoC, but it will not wait for analysis to complete. Enabling this option will cause the action to wait for analysis to complete. Note that this will cause the action to run longer.'
    required: false
    type: boolean
    default: false
  analysis_timeout_minutes:
    description: 'If wait_for_analysis is true, the number of minutes to wait for analysis to complete. The default is 30 minutes.'
    required: false
    default: 30
  fail_for_noncompliance:
    description: 'If wait_for_analysis is true, fail the job if any non-compliant issues are found in the scan.'
    required: false
    type: boolean
    default: false
  failure_threshold:
    description: 'If fail_for_noncompliance is enabled, the severity that indicates a failure. Lesser severities will not be considered a failure. For example, if failure_threshold is set to Medium, Informational and/or Low severity issues will not cause a failure. Medium, High, and/or Critical issues will cause a failure.'
    required: false
    type: choice
    default: 'Low'
    options:
    - Informational
    - Low
    - Medium
    - High
    - Critical
runs:
  using: 'node16'
  main: 'src/main.js'



  Name                           Value
----                           -----
ACCEPT_EULA                    Y
AGENT_TOOLSDIRECTORY           /opt/hostedtoolcache
ANDROID_HOME                   /usr/local/lib/android/sdk
ANDROID_NDK                    /usr/local/lib/android/sdk/ndk/25.2.9519653
ANDROID_NDK_HOME               /usr/local/lib/android/sdk/ndk/25.2.9519653
ANDROID_NDK_LATEST_HOME        /usr/local/lib/android/sdk/ndk/25.2.9519653
ANDROID_NDK_ROOT               /usr/local/lib/android/sdk/ndk/25.2.9519653
ANDROID_SDK_ROOT               /usr/local/lib/android/sdk
ANT_HOME                       /usr/share/ant
AZURE_EXTENSION_DIR            /opt/az/azcliextensions
BOOTSTRAP_HASKELL_NONINTERACT… 1
CHROME_BIN                     /usr/bin/google-chrome
CHROMEWEBDRIVER                /usr/local/share/chrome_driver
CI                             true
CONDA                          /usr/share/miniconda
DEBIAN_FRONTEND                noninteractive
DEPLOYMENT_BASEPATH            /opt/runner
DOTNET_MULTILEVEL_LOOKUP       0
DOTNET_NOLOGO                  1
DOTNET_SKIP_FIRST_TIME_EXPERI… 1
EDGEWEBDRIVER                  /usr/local/share/edge_driver
GECKOWEBDRIVER                 /usr/local/share/gecko_driver
GHCUP_INSTALL_BASE_PREFIX      /usr/local
GITHUB_ACTION                  __antonychiu2_asoc-dast-action
GITHUB_ACTION_PATH             /home/runner/work/_actions/antonychiu2/asoc-das…
GITHUB_ACTION_REF              
GITHUB_ACTION_REPOSITORY       
GITHUB_ACTIONS                 true
GITHUB_ACTOR                   antonychiu2
GITHUB_ACTOR_ID                5158535
GITHUB_API_URL                 https://api.github.com
GITHUB_BASE_REF                
GITHUB_ENV                     /home/runner/work/_temp/_runner_file_commands/s…
GITHUB_EVENT_NAME              push
GITHUB_EVENT_PATH              /home/runner/work/_temp/_github_workflow/event.…
GITHUB_GRAPHQL_URL             https://api.github.com/graphql
GITHUB_HEAD_REF                
GITHUB_JOB                     build
GITHUB_OUTPUT                  /home/runner/work/_temp/_runner_file_commands/s…
GITHUB_PATH                    /home/runner/work/_temp/_runner_file_commands/a…
GITHUB_REF                     refs/heads/Altoro-3.4
GITHUB_REF_NAME                Altoro-3.4
GITHUB_REF_PROTECTED           false
GITHUB_REF_TYPE                branch
GITHUB_REPOSITORY              antonychiu2/asoc-dast-action-demo
GITHUB_REPOSITORY_ID           611387207
GITHUB_REPOSITORY_OWNER        antonychiu2
GITHUB_REPOSITORY_OWNER_ID     5158535
GITHUB_RETENTION_DAYS          90
GITHUB_RUN_ATTEMPT             1
GITHUB_RUN_ID                  4377068955
GITHUB_RUN_NUMBER              12
GITHUB_SERVER_URL              https://github.com
GITHUB_SHA                     8860dee36be9c921928ed464ac2b04c527a0453b
GITHUB_STATE                   /home/runner/work/_temp/_runner_file_commands/s…
GITHUB_STEP_SUMMARY            /home/runner/work/_temp/_runner_file_commands/s…
GITHUB_TRIGGERING_ACTOR        antonychiu2
GITHUB_WORKFLOW                CI
GITHUB_WORKFLOW_REF            antonychiu2/asoc-dast-action-demo/.github/workf…
GITHUB_WORKFLOW_SHA            8860dee36be9c921928ed464ac2b04c527a0453b
GITHUB_WORKSPACE               /home/runner/work/asoc-dast-action-demo/asoc-da…
GOROOT_1_17_X64                /opt/hostedtoolcache/go/1.17.13/x64
GOROOT_1_18_X64                /opt/hostedtoolcache/go/1.18.10/x64
GOROOT_1_19_X64                /opt/hostedtoolcache/go/1.19.6/x64
GOROOT_1_20_X64                /opt/hostedtoolcache/go/1.20.1/x64
GRAALVM_11_ROOT                /usr/local/graalvm/graalvm-ce-java11-22.3.1
GRADLE_HOME                    /usr/share/gradle-8.0.2
HOME                           /home/runner
HOMEBREW_CLEANUP_PERIODIC_FUL… 3650
HOMEBREW_NO_AUTO_UPDATE        1
ImageOS                        ubuntu22
ImageVersion                   20230305.1
INVOCATION_ID                  c8c7c2d9e0d3404db6d6f1717539c922
JAVA_HOME                      /usr/lib/jvm/temurin-11-jdk-amd64
JAVA_HOME_11_X64               /usr/lib/jvm/temurin-11-jdk-amd64
JAVA_HOME_17_X64               /usr/lib/jvm/temurin-17-jdk-amd64
JAVA_HOME_8_X64                /usr/lib/jvm/temurin-8-jdk-amd64
JOURNAL_STREAM                 8:17023
LANG                           C.UTF-8
LEIN_HOME                      /usr/local/lib/lein
LEIN_JAR                       /usr/local/lib/lein/self-installs/leiningen-2.1…
NVM_DIR                        /home/runner/.nvm
PATH                           /opt/microsoft/powershell/7:/home/runner/.local…
PERFLOG_LOCATION_SETTING       RUNNER_PERFLOG
PIPX_BIN_DIR                   /opt/pipx_bin
PIPX_HOME                      /opt/pipx
POWERSHELL_DISTRIBUTION_CHANN… GitHub-Actions-ubuntu22
PSModulePath                   /home/runner/.local/share/powershell/Modules:/u…
RUNNER_ARCH                    X64
RUNNER_NAME                    Hosted Agent
RUNNER_OS                      Linux
RUNNER_PERFLOG                 /home/runner/perflog
RUNNER_TEMP                    /home/runner/work/_temp
RUNNER_TOOL_CACHE              /opt/hostedtoolcache
RUNNER_TRACKING_ID             github_c982bf43-fe76-4c43-8483-f9960524942b
RUNNER_USER                    runner
RUNNER_WORKSPACE               /home/runner/work/asoc-dast-action-demo
SELENIUM_JAR_PATH              /usr/share/java/selenium-server.jar
SGX_AESM_ADDR                  1
STATS_NM                       true
STATS_RDCL                     true
SWIFT_PATH                     /usr/share/swift/usr/bin
SYSTEMD_EXEC_PID               667
USER                           runner
VCPKG_INSTALLATION_ROOT        /usr/local/share/vcpkg
XDG_CONFIG_HOME                /home/runner/.config
XDG_RUNTIME_DIR                /run/user/1001
